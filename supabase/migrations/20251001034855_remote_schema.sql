revoke delete on table "public"."attendance" from "anon";

revoke insert on table "public"."attendance" from "anon";

revoke references on table "public"."attendance" from "anon";

revoke select on table "public"."attendance" from "anon";

revoke trigger on table "public"."attendance" from "anon";

revoke truncate on table "public"."attendance" from "anon";

revoke update on table "public"."attendance" from "anon";

revoke delete on table "public"."attendance" from "authenticated";

revoke insert on table "public"."attendance" from "authenticated";

revoke references on table "public"."attendance" from "authenticated";

revoke select on table "public"."attendance" from "authenticated";

revoke trigger on table "public"."attendance" from "authenticated";

revoke truncate on table "public"."attendance" from "authenticated";

revoke update on table "public"."attendance" from "authenticated";

revoke delete on table "public"."attendance" from "service_role";

revoke insert on table "public"."attendance" from "service_role";

revoke references on table "public"."attendance" from "service_role";

revoke select on table "public"."attendance" from "service_role";

revoke trigger on table "public"."attendance" from "service_role";

revoke truncate on table "public"."attendance" from "service_role";

revoke update on table "public"."attendance" from "service_role";

revoke delete on table "public"."enrolment" from "anon";

revoke insert on table "public"."enrolment" from "anon";

revoke references on table "public"."enrolment" from "anon";

revoke select on table "public"."enrolment" from "anon";

revoke trigger on table "public"."enrolment" from "anon";

revoke truncate on table "public"."enrolment" from "anon";

revoke update on table "public"."enrolment" from "anon";

revoke delete on table "public"."enrolment" from "authenticated";

revoke insert on table "public"."enrolment" from "authenticated";

revoke references on table "public"."enrolment" from "authenticated";

revoke select on table "public"."enrolment" from "authenticated";

revoke trigger on table "public"."enrolment" from "authenticated";

revoke truncate on table "public"."enrolment" from "authenticated";

revoke update on table "public"."enrolment" from "authenticated";

revoke delete on table "public"."enrolment" from "service_role";

revoke insert on table "public"."enrolment" from "service_role";

revoke references on table "public"."enrolment" from "service_role";

revoke select on table "public"."enrolment" from "service_role";

revoke trigger on table "public"."enrolment" from "service_role";

revoke truncate on table "public"."enrolment" from "service_role";

revoke update on table "public"."enrolment" from "service_role";

revoke delete on table "public"."meeting" from "anon";

revoke insert on table "public"."meeting" from "anon";

revoke references on table "public"."meeting" from "anon";

revoke select on table "public"."meeting" from "anon";

revoke trigger on table "public"."meeting" from "anon";

revoke truncate on table "public"."meeting" from "anon";

revoke update on table "public"."meeting" from "anon";

revoke delete on table "public"."meeting" from "authenticated";

revoke insert on table "public"."meeting" from "authenticated";

revoke references on table "public"."meeting" from "authenticated";

revoke select on table "public"."meeting" from "authenticated";

revoke trigger on table "public"."meeting" from "authenticated";

revoke truncate on table "public"."meeting" from "authenticated";

revoke update on table "public"."meeting" from "authenticated";

revoke delete on table "public"."meeting" from "service_role";

revoke insert on table "public"."meeting" from "service_role";

revoke references on table "public"."meeting" from "service_role";

revoke select on table "public"."meeting" from "service_role";

revoke trigger on table "public"."meeting" from "service_role";

revoke truncate on table "public"."meeting" from "service_role";

revoke update on table "public"."meeting" from "service_role";

revoke delete on table "public"."member" from "anon";

revoke insert on table "public"."member" from "anon";

revoke references on table "public"."member" from "anon";

revoke select on table "public"."member" from "anon";

revoke trigger on table "public"."member" from "anon";

revoke truncate on table "public"."member" from "anon";

revoke update on table "public"."member" from "anon";

revoke delete on table "public"."member" from "authenticated";

revoke insert on table "public"."member" from "authenticated";

revoke references on table "public"."member" from "authenticated";

revoke select on table "public"."member" from "authenticated";

revoke trigger on table "public"."member" from "authenticated";

revoke truncate on table "public"."member" from "authenticated";

revoke update on table "public"."member" from "authenticated";

revoke delete on table "public"."member" from "service_role";

revoke insert on table "public"."member" from "service_role";

revoke references on table "public"."member" from "service_role";

revoke select on table "public"."member" from "service_role";

revoke trigger on table "public"."member" from "service_role";

revoke truncate on table "public"."member" from "service_role";

revoke update on table "public"."member" from "service_role";

revoke delete on table "public"."message" from "anon";

revoke insert on table "public"."message" from "anon";

revoke references on table "public"."message" from "anon";

revoke select on table "public"."message" from "anon";

revoke trigger on table "public"."message" from "anon";

revoke truncate on table "public"."message" from "anon";

revoke update on table "public"."message" from "anon";

revoke delete on table "public"."message" from "authenticated";

revoke insert on table "public"."message" from "authenticated";

revoke references on table "public"."message" from "authenticated";

revoke select on table "public"."message" from "authenticated";

revoke trigger on table "public"."message" from "authenticated";

revoke truncate on table "public"."message" from "authenticated";

revoke update on table "public"."message" from "authenticated";

revoke delete on table "public"."message" from "service_role";

revoke insert on table "public"."message" from "service_role";

revoke references on table "public"."message" from "service_role";

revoke select on table "public"."message" from "service_role";

revoke trigger on table "public"."message" from "service_role";

revoke truncate on table "public"."message" from "service_role";

revoke update on table "public"."message" from "service_role";

revoke delete on table "public"."profile" from "anon";

revoke insert on table "public"."profile" from "anon";

revoke references on table "public"."profile" from "anon";

revoke select on table "public"."profile" from "anon";

revoke trigger on table "public"."profile" from "anon";

revoke truncate on table "public"."profile" from "anon";

revoke update on table "public"."profile" from "anon";

revoke delete on table "public"."profile" from "authenticated";

revoke insert on table "public"."profile" from "authenticated";

revoke references on table "public"."profile" from "authenticated";

revoke select on table "public"."profile" from "authenticated";

revoke trigger on table "public"."profile" from "authenticated";

revoke truncate on table "public"."profile" from "authenticated";

revoke update on table "public"."profile" from "authenticated";

revoke delete on table "public"."profile" from "service_role";

revoke insert on table "public"."profile" from "service_role";

revoke references on table "public"."profile" from "service_role";

revoke select on table "public"."profile" from "service_role";

revoke trigger on table "public"."profile" from "service_role";

revoke truncate on table "public"."profile" from "service_role";

revoke update on table "public"."profile" from "service_role";

revoke delete on table "public"."room" from "anon";

revoke insert on table "public"."room" from "anon";

revoke references on table "public"."room" from "anon";

revoke select on table "public"."room" from "anon";

revoke trigger on table "public"."room" from "anon";

revoke truncate on table "public"."room" from "anon";

revoke update on table "public"."room" from "anon";

revoke delete on table "public"."room" from "authenticated";

revoke insert on table "public"."room" from "authenticated";

revoke references on table "public"."room" from "authenticated";

revoke select on table "public"."room" from "authenticated";

revoke trigger on table "public"."room" from "authenticated";

revoke truncate on table "public"."room" from "authenticated";

revoke update on table "public"."room" from "authenticated";

revoke delete on table "public"."room" from "service_role";

revoke insert on table "public"."room" from "service_role";

revoke references on table "public"."room" from "service_role";

revoke select on table "public"."room" from "service_role";

revoke trigger on table "public"."room" from "service_role";

revoke truncate on table "public"."room" from "service_role";

revoke update on table "public"."room" from "service_role";

revoke delete on table "public"."squad" from "anon";

revoke insert on table "public"."squad" from "anon";

revoke references on table "public"."squad" from "anon";

revoke select on table "public"."squad" from "anon";

revoke trigger on table "public"."squad" from "anon";

revoke truncate on table "public"."squad" from "anon";

revoke update on table "public"."squad" from "anon";

revoke delete on table "public"."squad" from "authenticated";

revoke insert on table "public"."squad" from "authenticated";

revoke references on table "public"."squad" from "authenticated";

revoke select on table "public"."squad" from "authenticated";

revoke trigger on table "public"."squad" from "authenticated";

revoke truncate on table "public"."squad" from "authenticated";

revoke update on table "public"."squad" from "authenticated";

revoke delete on table "public"."squad" from "service_role";

revoke insert on table "public"."squad" from "service_role";

revoke references on table "public"."squad" from "service_role";

revoke select on table "public"."squad" from "service_role";

revoke trigger on table "public"."squad" from "service_role";

revoke truncate on table "public"."squad" from "service_role";

revoke update on table "public"."squad" from "service_role";

alter table "public"."enrolment" drop constraint "enrolment_user_fkey";

alter table "public"."meeting" drop constraint "meeting_creator_fkey";

alter table "public"."meeting" drop constraint "meeting_room_fkey";

alter table "public"."squad" drop constraint "Squad_creator_fkey";

alter table "public"."enrolment" drop constraint "enrolment_room_fkey";

alter table "public"."message" drop constraint "message_sender_fkey";

alter table "public"."room" drop constraint "room_name_key";

alter table "public"."room" drop constraint "room_pkey";

drop index if exists "public"."room_name_key";

drop index if exists "public"."room_pkey";

alter table "public"."enrolment" drop column "user";

alter table "public"."enrolment" add column "user_id" uuid not null;

alter table "public"."meeting" drop column "creator";

alter table "public"."meeting" drop column "room";

alter table "public"."meeting" add column "creator_id" uuid not null;

alter table "public"."meeting" add column "room_id" text;

alter table "public"."message" drop column "sender";

alter table "public"."message" add column "sender_id" uuid not null;

alter table "public"."message" alter column "body" set not null;

alter table "public"."profile" alter column "profile_url" drop not null;

alter table "public"."room" drop column "name";

alter table "public"."room" add column "id" text not null;

alter table "public"."squad" drop column "creator";

alter table "public"."squad" add column "creator_id" uuid not null;

CREATE UNIQUE INDEX member_squad_id_key ON public.member USING btree (squad_id);

CREATE UNIQUE INDEX room_name_key ON public.room USING btree (id);

CREATE UNIQUE INDEX room_pkey ON public.room USING btree (id);

alter table "public"."room" add constraint "room_pkey" PRIMARY KEY using index "room_pkey";

alter table "public"."enrolment" add constraint "enrolment_user_id_fkey" FOREIGN KEY (user_id) REFERENCES auth.users(id) ON UPDATE CASCADE ON DELETE CASCADE not valid;

alter table "public"."enrolment" validate constraint "enrolment_user_id_fkey";

alter table "public"."meeting" add constraint "meeting_creator_id_fkey" FOREIGN KEY (creator_id) REFERENCES auth.users(id) ON UPDATE CASCADE ON DELETE CASCADE not valid;

alter table "public"."meeting" validate constraint "meeting_creator_id_fkey";

alter table "public"."meeting" add constraint "meeting_room_id_fkey" FOREIGN KEY (room_id) REFERENCES room(id) not valid;

alter table "public"."meeting" validate constraint "meeting_room_id_fkey";

alter table "public"."member" add constraint "member_squad_id_key" UNIQUE using index "member_squad_id_key";

alter table "public"."squad" add constraint "squad_creator_id_fkey" FOREIGN KEY (creator_id) REFERENCES auth.users(id) not valid;

alter table "public"."squad" validate constraint "squad_creator_id_fkey";

alter table "public"."enrolment" add constraint "enrolment_room_fkey" FOREIGN KEY (room) REFERENCES room(id) not valid;

alter table "public"."enrolment" validate constraint "enrolment_room_fkey";

alter table "public"."message" add constraint "message_sender_fkey" FOREIGN KEY (sender_id) REFERENCES auth.users(id) ON UPDATE CASCADE ON DELETE CASCADE not valid;

alter table "public"."message" validate constraint "message_sender_fkey";

alter table "public"."room" add constraint "room_name_key" UNIQUE using index "room_name_key";


CREATE TRIGGER trigger_handle_new_user_create_profile AFTER INSERT ON auth.users FOR EACH ROW EXECUTE FUNCTION handle_new_user_create_profile();


